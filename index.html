<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="recorder">
<meta property="og:type" content="website">
<meta property="og:title" content="Conlonial&#39;s blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Conlonial&#39;s blog">
<meta property="og:description" content="recorder">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Conlonial&#39;s blog">
<meta name="twitter:description" content="recorder">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>Conlonial's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Conlonial's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/08/Rapid-Typing-fd-in-pwnable-col/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Conlonial">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Conlonial's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/08/Rapid-Typing-fd-in-pwnable-col/" itemprop="url">Rapid Typing & fd in pwnable & col</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-08T18:28:26+08:00">
                2019-08-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><center> Rapid Typing&amp; fd in pwnable &amp; col</center></p>
<p><center> —– Rapid Typing—–</center></p>
<h3 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h3><ul>
<li>python核心编程 15章正则表达式</li>
<li>SVG代码转图片<blockquote>
<p><a href="https://me.jinchuang.org/archives/392.html" target="_blank" rel="noopener">https://me.jinchuang.org/archives/392.html</a></p>
</blockquote>
</li>
</ul>
<hr>
<h3 id="分析："><a href="#分析：" class="headerlink" title="分析："></a>分析：</h3><p> 思路参考calulator，不同点在本题所需输入的内容为svg图片，<br> svg部分截取： <img src="https://i.imgur.com/N9abOzn.png" alt="Imgur"><br> 解码后：<img src="https://i.imgur.com/HSw1uC6.png" alt="Imgur"><br> 可见它的代码是xy的二维坐标，将svg图片代码段截取后，转为png图片后，可见，即为我们所求输入内容。<br> 按照x坐标排列后，可见<code>&gt;a-z 0-9&lt;</code> 内即为所求，按正则匹配：<br> <img src="https://i.imgur.com/5ItHC10.png" alt="Imgur"><br>  再匹配去掉<code>&gt;&lt;</code> 化为字符串即可：<br> <img src="https://i.imgur.com/Od5TucA.png" alt="Imgur"><br> 代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;le&gt; import requests</span><br><span class="line">import base64</span><br><span class="line">import re</span><br><span class="line">r = requests.get(&apos;http://123.207.149.64:23331/captcha/&apos;)</span><br><span class="line">&gt;  soup = BeautifulSoup(r.text,&apos;lxml&apos;)      </span><br><span class="line">p = soup.find(name=&apos;img&apos;) </span><br><span class="line">q = str(p)</span><br><span class="line">s= q[36:-4]           #把svg代码部分截出</span><br><span class="line">lens = len(s)</span><br><span class="line">lenx = lens - (lens % 4 if lens % 4 else 4)</span><br><span class="line">try:</span><br><span class="line">    result = base64.decodestring(s[:lenx])</span><br><span class="line">except:</span><br><span class="line">   pass   #10-15是解决base64解码直接decode出现的 TypeError: Incorrect padding错误 注：https://blog.csdn.net/lisai17/article/details/21091791</span><br><span class="line">anwser = BeautifulSoup(result,&apos;lxml&apos;)</span><br><span class="line">a = anwser.find_all(name=&apos;text&apos;)</span><br><span class="line">b = sorted(a,key=lambda x:int(x.get(&apos;x&apos;))) #对text内容以x大小为序排列</span><br><span class="line">c = &apos;&gt;\w&lt;&apos; #正则匹配出所有特定字符</span><br><span class="line">d = re.findall(c,str(b)) #注意正则匹配模式串还有要匹配的串必须是字符串类型，用str转换 </span><br><span class="line">g = re.findall(&apos;\w&apos;,str(d))</span><br><span class="line">h = &apos;&apos;.join(g) #把列表转化为字符串</span><br><span class="line">print h</span><br><span class="line">r = requests.get (&apos;http://123.207.149.64:23331/captcha/?code=&apos;+h, cookies=r.cookies)</span><br><span class="line">print r.text`</span><br></pre></td></tr></table></figure></p>
<hr>
<p><center>—–fd—–</center></p>
<h3 id="参考：-1"><a href="#参考：-1" class="headerlink" title="参考："></a>参考：</h3><ul>
<li>fd：文件描述符—标准输入(standard input)的文件描述符是 0，标准输出(standard output)是1,标准错误(standard error)是 2 .<blockquote>
<p>注：<a href="https://blog.csdn.net/cywosp/article/details/38965239" target="_blank" rel="noopener">https://blog.csdn.net/cywosp/article/details/38965239</a></p>
</blockquote>
</li>
</ul>
<ul>
<li>read函数 ：ssize_t read(int fd,void * buf ,size_t count);<br>read()会把参数fd所指的文件传送nbyte个字节到buf指针所指的内存中。若参数nbyte为0，则read()不会有作用并返回0。返回值为实际读取到的字节数，如果返回0，表示已到达文件尾或无可读取的数据。错误返回-1,并将根据不同的错误原因适当的设置错误码。</li>
</ul>
<ul>
<li><p>atoi函数：atoi() 函数用来将字符串转换成整数(int)，其原型为：int atoi (const char * str);【函数说明】atoi() 函数会扫描参数 str 字符串，跳过前面的空白字符（例如空格，tab缩进等，可以通过isspace()函数来检测），直到遇上数字或正负符号才开始做转换，而再遇到非数字或字符串结束时(‘\0’)才结束转换，并将结果返回。【返回值】返回转换后的整型数；如果 str 不能转换成 int 或者 str 为空字符串，那么将返回 0。</p>
</li>
<li><p>arec，argv[] int main(int argc,char *argv[]);第一个参数argc用来存放命令行参数的个数；第二个参数argv是指针数组，它是用来存放命令行中各个参数和命令字的字符串的。关于相关输入：要在执行文件语句后直接加赋值。</p>
<blockquote>
<p>例：<a href="https://blog.csdn.net/Eastmount/article/details/20413773" target="_blank" rel="noopener">https://blog.csdn.net/Eastmount/article/details/20413773</a></p>
</blockquote>
</li>
</ul>
<hr>
<h3 id="分析：-1"><a href="#分析：-1" class="headerlink" title="分析："></a>分析：</h3><p>通过所给远程端口获取题目，ls后，有fd(ELF) ，fd.c ，flag三文件，fd为fd.c编译。尝试打开flag 没有权限 打开fd.c查看源码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">char buf[32];</span><br><span class="line">int main(int argc, char* argv[], char* envp[])&#123;</span><br><span class="line">	if(argc&lt;2)&#123;</span><br><span class="line">		printf(&quot;pass argv[1] a number\n&quot;);</span><br><span class="line">		return 0;</span><br><span class="line">	&#125;</span><br><span class="line">	int fd = atoi( argv[1] ) - 0x1234;</span><br><span class="line">	int len = 0;</span><br><span class="line">	len = read(fd, buf, 32);</span><br><span class="line">	if(!strcmp(&quot;LETMEWIN\n&quot;, buf))&#123;</span><br><span class="line">		printf(&quot;good job :)\n&quot;);</span><br><span class="line">		system(&quot;/bin/cat flag&quot;);</span><br><span class="line">		exit(0);</span><br><span class="line">	&#125;</span><br><span class="line">	printf(&quot;learn about Linux file IO\n&quot;);</span><br><span class="line">	return 0;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们希望执行<code>system(&quot;/bin/cat flag&quot;)</code>; 故需执行<code>!strcmp(&quot;LETMEWIN\n&quot;, buf)</code>，即令<code>buf=LETMEWIN</code><br>看到<code>read(fd,buf,32)</code>，由read函数的定义，需要使fd==0，即标准输入 故<code>fd=0x1234=4660</code><br>输入<code>./fd 4660</code>后可进行输入，输入<code>LETMEWIN</code>，得flag</p>
<hr>
<p><center>—–col—–</center></p>
<h3 id="参考：-2"><a href="#参考：-2" class="headerlink" title="参考："></a>参考：</h3><ul>
<li>hash collision 就是针对哈希函数的特性，精心构造数据，使所有数据的哈希值相同，当这些数据保存到哈希表中，哈希表就会退化为单链表，哈希表的各种操作的时间复杂度提升一个数量级，因此会消耗大量CPU资源，导致系统无法快速响应请求，从而达到拒绝服务攻击（Dos）的目的。 本题就是构造与所给hashcode相同的值 <blockquote>
<p>注：<a href="https://www.kawabangga.com/posts/2493" target="_blank" rel="noopener">https://www.kawabangga.com/posts/2493</a> <a href="http://vearne.cc/archives/34477" target="_blank" rel="noopener">http://vearne.cc/archives/34477</a></p>
</blockquote>
</li>
<li>《深入理解计算机系统》2.1.4节，大部分机器存储对象以小端法存储.</li>
<li>关于输入，使用了shell语言中的反括号，反引号在Linux shell命令行中有特殊的含义：反引号间的内容，会被shell先执行。其输出被放入主命令后，主命令再被执行 <blockquote>
<p>注：<a href="https://www.jianshu.com/p/ed41f2e48464" target="_blank" rel="noopener">https://www.jianshu.com/p/ed41f2e48464</a></p>
</blockquote>
</li>
</ul>
<hr>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>与fd相似，按所给进行远程连接后，打开col.c分析 源码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">unsigned long hashcode = 0x21DD09EC;</span><br><span class="line">unsigned long check_password(const char* p)&#123;</span><br><span class="line">	int* ip = (int*)p;</span><br><span class="line">	int i;</span><br><span class="line">	int res=0;</span><br><span class="line">	for(i=0; i&lt;5; i++)&#123;</span><br><span class="line">		res += ip[i];</span><br><span class="line">	&#125;</span><br><span class="line">	return res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main(int argc, char* argv[])&#123;</span><br><span class="line">	if(argc&lt;2)&#123;</span><br><span class="line">		printf(&quot;usage : %s [passcode]\n&quot;, argv[0]);</span><br><span class="line">		return 0;</span><br><span class="line">	&#125;</span><br><span class="line">	if(strlen(argv[1]) != 20)&#123;</span><br><span class="line">		printf(&quot;passcode length should be 20 bytes\n&quot;);</span><br><span class="line">		return 0;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	if(hashcode == check_password( argv[1] ))&#123;</span><br><span class="line">		system(&quot;/bin/cat flag&quot;);</span><br><span class="line">		return 0;</span><br><span class="line">	&#125;</span><br><span class="line">	else</span><br><span class="line">		printf(&quot;wrong passcode.\n&quot;);</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>首先定义了函数<code>check_password</code>,作用是将p(char类型，1字节)，强制转化为int型(4字节)再赋给ip，循环5次相加后得到一个20字节的数<br> 再看main函数部分后，得知当传入的参数经<code>check_password</code>后与所给的hashcode相同时 获得flag，所以20个字节的char p会被分成5段，一段4个字节，<br>就是我们找5个数相加为<code>0x21DD09EC</code>即可。<br>我先将<code>0x21DD09EC</code>转为10进制数后，随便找了一个数(123456789)*4后，相减得到最后一个数(16进制：<code>0x46DD598</code>)。<br>另外注意在输入时使用小端输入。 输入为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./col &apos;0x75BCD15&apos;*4+&apos;0X46DD598&apos;</span><br></pre></td></tr></table></figure></p>
<p>但是在直接输入了后依然不对，最后找到原因是shell不能直接识别这样的输入，需要写shell语言格式或利用其他语言传参。用其它语言用反括号隔开<br>正确输入为:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./col `python -c &quot;print &apos;\x15\xcd\x5b\x07&apos; * 4 + &apos;\x98\xd5\x6d\x04&apos;&quot;`</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/22/postweb-题解-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Conlonial">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Conlonial's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/22/postweb-题解-1/" itemprop="url">web 题解(1)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-07-22T20:20:27+08:00">
                2019-07-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="web-题解"><a href="#web-题解" class="headerlink" title="web 题解 "></a><center>web 题解 </center></h1><h2 id="basic-php"><a href="#basic-php" class="headerlink" title="basic php"></a>basic php</h2><h5 id="参考"><a href="#参考" class="headerlink" title="参考:"></a><p align="left">参考:</p></h5><p><a href="https://hackfun.org/2018/01/09/CTF%E4%B8%AD%E5%B8%B8%E8%A7%81PHP%E7%89%B9%E6%80%A7%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener">https://hackfun.org/2018/01/09/CTF%E4%B8%AD%E5%B8%B8%E8%A7%81PHP%E7%89%B9%E6%80%A7%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</a></p>
<h5 id="playload1（参考23）-http-123-207-149-64-23331-feature-name-1-amp-password-1-amp-test-QNKCDZO"><a href="#playload1（参考23）-http-123-207-149-64-23331-feature-name-1-amp-password-1-amp-test-QNKCDZO" class="headerlink" title="playload1（参考23）:http://123.207.149.64:23331/feature/?name=1&amp;password=1&amp;test=QNKCDZO"></a><p align="left">playload1（参考23）:</p><code>http://123.207.149.64:23331/feature/?name=1&amp;password=1&amp;test=QNKCDZO</code></h5><h3 id="另：不赋值的方法本题不使用，具体原因待测"><a href="#另：不赋值的方法本题不使用，具体原因待测" class="headerlink" title="另：不赋值的方法本题不使用，具体原因待测"></a>另：不赋值的方法本题不使用，具体原因待测</h3><h5 id="playload2（参考07）-http-123-207-149-64-23331-feature-name-1-amp-password-2-amp-test-QNKCDZO"><a href="#playload2（参考07）-http-123-207-149-64-23331-feature-name-1-amp-password-2-amp-test-QNKCDZO" class="headerlink" title="playload2（参考07）:http://123.207.149.64:23331/feature/?name[]=1&amp;password[]=2&amp;test=QNKCDZO"></a><p align="left">playload2（参考07）:</p><code>http://123.207.149.64:23331/feature/?name[]=1&amp;password[]=2&amp;test=QNKCDZO</code></h5><h3 id="Hint：由于sha1-函数和md5-函数在处理传入参数为数组时会报警并都返回NULL，构造并传入2个不同数组便可以成功通过if-GET-39-name-39-GET-39-password-39-和else-if-sha1-GET-39-name-39-sha1-GET-39-password-39-检测。"><a href="#Hint：由于sha1-函数和md5-函数在处理传入参数为数组时会报警并都返回NULL，构造并传入2个不同数组便可以成功通过if-GET-39-name-39-GET-39-password-39-和else-if-sha1-GET-39-name-39-sha1-GET-39-password-39-检测。" class="headerlink" title="Hint：由于sha1()函数和md5()函数在处理传入参数为数组时会报警并都返回NULL，构造并传入2个不同数组便可以成功通过if ($_GET[&#39;name&#39;] == $_GET[&#39;password&#39;])和else if (sha1($_GET[&#39;name&#39;]) === sha1($_GET[&#39;password&#39;]))检测。"></a>Hint：由于sha1()函数和md5()函数在处理传入参数为数组时会报警并都返回NULL，构造并传入2个不同数组便可以成功通过<code>if ($_GET[&#39;name&#39;] == $_GET[&#39;password&#39;])</code>和<code>else if (sha1($_GET[&#39;name&#39;]) === sha1($_GET[&#39;password&#39;]))</code>检测。</h3><h2 id="basic-php2"><a href="#basic-php2" class="headerlink" title="basic php2"></a>basic php2</h2><h5 id="参考-https-www-bodkin-ren-index-php-archives-168-ereg-和strpos-部分例子"><a href="#参考-https-www-bodkin-ren-index-php-archives-168-ereg-和strpos-部分例子" class="headerlink" title="参考:https://www.bodkin.ren/index.php/archives/168/  ereg()和strpos()部分例子"></a><p align="left">参考:</p><a href="https://www.bodkin.ren/index.php/archives/168/" target="_blank" rel="noopener">https://www.bodkin.ren/index.php/archives/168/</a>  ereg()和strpos()部分例子</h5><h5 id="1-is-int-函数用于检测变量是否是整数。"><a href="#1-is-int-函数用于检测变量是否是整数。" class="headerlink" title="1. is_int() 函数用于检测变量是否是整数。"></a>1. is_int() 函数用于检测变量是否是整数。</h5><h5 id="2-strpos-函数：查找字符串在另一字符串中第一次出现的位置。"><a href="#2-strpos-函数：查找字符串在另一字符串中第一次出现的位置。" class="headerlink" title="2. strpos() 函数：查找字符串在另一字符串中第一次出现的位置。"></a>2. strpos() 函数：查找字符串在另一字符串中第一次出现的位置。</h5><h3 id="Hint-strpos-函数对大小写敏感。与ereg（）两个函数都是处理字符串的函数；这时就可以利用数组来绕过；"><a href="#Hint-strpos-函数对大小写敏感。与ereg（）两个函数都是处理字符串的函数；这时就可以利用数组来绕过；" class="headerlink" title="Hint: strpos() 函数对大小写敏感。与ereg（）两个函数都是处理字符串的函数；这时就可以利用数组来绕过；"></a><p align="left">Hint:</p> strpos() 函数对大小写敏感。与ereg（）两个函数都是处理字符串的函数；这时就可以利用数组来绕过；</h3><h5 id="playload-http-123-207-149-64-23360-user-27416cf22fc4ed74b1cd264585053b57fed14088-index-php-content-php"><a href="#playload-http-123-207-149-64-23360-user-27416cf22fc4ed74b1cd264585053b57fed14088-index-php-content-php" class="headerlink" title="playload: http://123.207.149.64:23360/user/27416cf22fc4ed74b1cd264585053b57fed14088/index.php?content[]=php"></a>playload: <code>http://123.207.149.64:23360/user/27416cf22fc4ed74b1cd264585053b57fed14088/index.php?content[]=php</code></h5><h2 id="Basicfileinclude"><a href="#Basicfileinclude" class="headerlink" title="Basicfileinclude"></a>Basicfileinclude</h2><h5 id="参考-1"><a href="#参考-1" class="headerlink" title="参考:"></a><p align="left">参考:</p></h5><pre><code>1. 白帽子php文件包含漏洞部分；
2. http://mang0.me/archis/844a29d4/
3. https://www.smi1e.top/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E4%B8%8Ephp%E4%BC%AA%E5%8D%8F%E8%AE%AE/ 
4. https://xz.aliyun.com/t/3085
</code></pre><h5 id="由上述可知关键在-php-filter-可以读取本地文件，而-index-php-file-php-filter-read-convert-base64-encode-resource-index-php"><a href="#由上述可知关键在-php-filter-可以读取本地文件，而-index-php-file-php-filter-read-convert-base64-encode-resource-index-php" class="headerlink" title="由上述可知关键在 php://filter 可以读取本地文件，而 index.php?file=php://filter/read=convert.base64-encode/resource=index.php"></a>由上述可知关键在 <code>php://filter</code> 可以读取本地文件，而 <code>index.php?file=php://filter/read=convert.base64-encode/resource=index.php</code></h5><p>指定末尾文件，可以读到base64编码后的文件内容，ctf中常有题目可读文件源码。</p>
<h5 id="playload-http-123-207-149-64-23338-page-php-filter-read-convert-base64-encode-resource-flag"><a href="#playload-http-123-207-149-64-23338-page-php-filter-read-convert-base64-encode-resource-flag" class="headerlink" title="playload:http://123.207.149.64:23338/?page=php://filter/read=convert.base64-encode/resource=flag"></a><p align="left">playload:</p><code>http://123.207.149.64:23338/?page=php://filter/read=convert.base64-encode/resource=flag</code></h5><h5 id="ubuntu-base64解码指令：-echo-aGEgaGE-IHlvdSB3YW50IGZsYWc-IGZsYWcgaXMgaGVyZTw-cGhwDQovLyB0cnkgdG8gcmVhZCB0aGlzIHNvdXJjZSBjb2RlDQovLyRmbGFnID0gJ2ZsYWd7cmVhbGx5X2Jhc2ljX3NraWxsX3dlYl9kb2dfc2hvdWxkX2tub3d9JzsNCj8-LCBidXQgZG9uJ3QgbGV0IHlvdSBzZWUhDQo-base64-decode"><a href="#ubuntu-base64解码指令：-echo-aGEgaGE-IHlvdSB3YW50IGZsYWc-IGZsYWcgaXMgaGVyZTw-cGhwDQovLyB0cnkgdG8gcmVhZCB0aGlzIHNvdXJjZSBjb2RlDQovLyRmbGFnID0gJ2ZsYWd7cmVhbGx5X2Jhc2ljX3NraWxsX3dlYl9kb2dfc2hvdWxkX2tub3d9JzsNCj8-LCBidXQgZG9uJ3QgbGV0IHlvdSBzZWUhDQo-base64-decode" class="headerlink" title="ubuntu base64解码指令： echo aGEgaGE/IHlvdSB3YW50IGZsYWc/IGZsYWcgaXMgaGVyZTw/cGhwDQovLyB0cnkgdG8gcmVhZCB0aGlzIHNvdXJjZSBjb2RlDQovLyRmbGFnID0gJ2ZsYWd7cmVhbGx5X2Jhc2ljX3NraWxsX3dlYl9kb2dfc2hvdWxkX2tub3d9JzsNCj8+LCBidXQgZG9uJ3QgbGV0IHlvdSBzZWUhDQo= | base64 --decode"></a><p align="left">ubuntu base64解码指令：</p> <code>echo aGEgaGE/IHlvdSB3YW50IGZsYWc/IGZsYWcgaXMgaGVyZTw/cGhwDQovLyB0cnkgdG8gcmVhZCB0aGlzIHNvdXJjZSBjb2RlDQovLyRmbGFnID0gJ2ZsYWd7cmVhbGx5X2Jhc2ljX3NraWxsX3dlYl9kb2dfc2hvdWxkX2tub3d9JzsNCj8+LCBidXQgZG9uJ3QgbGV0IHlvdSBzZWUhDQo= | base64 --decode</code></h5>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/02/20100502进度/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Conlonial">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Conlonial's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/02/20100502进度/" itemprop="url">20100502进度</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-05-02T21:21:44+08:00">
                2019-05-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="20190502进度"><a href="#20190502进度" class="headerlink" title="20190502进度"></a>20190502进度</h1><h2 id="HTML-amp-PHP学习笔记"><a href="#HTML-amp-PHP学习笔记" class="headerlink" title="HTML&amp;PHP学习笔记"></a>HTML&amp;PHP学习笔记</h2><h3 id="1-属性值应该始终被包括在引号内-一般使用双引号，当属性值带括号时使用单引号"><a href="#1-属性值应该始终被包括在引号内-一般使用双引号，当属性值带括号时使用单引号" class="headerlink" title="1. 属性值应该始终被包括在引号内,一般使用双引号，当属性值带括号时使用单引号"></a>1. 属性值应该始终被包括在引号内,一般使用双引号，当属性值带括号时使用单引号</h3><h3 id="2-在不产生一个新段落的情况下进行换行（新行），请使用-标签"><a href="#2-在不产生一个新段落的情况下进行换行（新行），请使用-标签" class="headerlink" title="2. 在不产生一个新段落的情况下进行换行（新行），请使用   标签"></a>2. 在不产生一个新段落的情况下进行换行（新行），请使用 <br>  标签</h3><h3 id="3-对于-HTML，无法通过在-HTML-代码中添加额外的空格或换行来改变输出的效果。当显示页面时，浏览器会移除源代码中多余的空格和空行。所有连续的空格或空行都会被算作一个空格。需要注意的是，HTML-代码中的所有连续的空行（换行）也被显示为一个空格"><a href="#3-对于-HTML，无法通过在-HTML-代码中添加额外的空格或换行来改变输出的效果。当显示页面时，浏览器会移除源代码中多余的空格和空行。所有连续的空格或空行都会被算作一个空格。需要注意的是，HTML-代码中的所有连续的空行（换行）也被显示为一个空格" class="headerlink" title="3.对于 HTML，无法通过在 HTML 代码中添加额外的空格或换行来改变输出的效果。当显示页面时，浏览器会移除源代码中多余的空格和空行。所有连续的空格或空行都会被算作一个空格。需要注意的是，HTML 代码中的所有连续的空行（换行）也被显示为一个空格"></a>3.对于 HTML，无法通过在 HTML 代码中添加额外的空格或换行来改变输出的效果。当显示页面时，浏览器会移除源代码中多余的空格和空行。所有连续的空格或空行都会被算作一个空格。需要注意的是，HTML 代码中的所有连续的空行（换行）也被显示为一个空格</h3><h3 id="4-PHP-EOF以-lt-lt-lt-EOF-开始标记开始，以-EOF-结束标记结束，结束标记必须顶头写，不能有缩进和空格，且在结束标记末尾要有分号-，结尾单独占一行"><a href="#4-PHP-EOF以-lt-lt-lt-EOF-开始标记开始，以-EOF-结束标记结束，结束标记必须顶头写，不能有缩进和空格，且在结束标记末尾要有分号-，结尾单独占一行" class="headerlink" title="4.PHP EOF以 &lt;&lt;&lt;EOF 开始标记开始，以 EOF 结束标记结束，结束标记必须顶头写，不能有缩进和空格，且在结束标记末尾要有分号 ，结尾单独占一行"></a>4.PHP EOF以 &lt;&lt;&lt;EOF 开始标记开始，以 EOF 结束标记结束，结束标记必须顶头写，不能有缩进和空格，且在结束标记末尾要有分号 ，结尾单独占一行</h3><h3 id="5-今天简单学习和动手编写了html与php，明天学习phpmysql"><a href="#5-今天简单学习和动手编写了html与php，明天学习phpmysql" class="headerlink" title="5.今天简单学习和动手编写了html与php，明天学习phpmysql"></a>5.今天简单学习和动手编写了html与php，明天学习phpmysql</h3>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/29/20190429进度/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Conlonial">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Conlonial's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/29/20190429进度/" itemprop="url">20190429进度</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-29T20:45:58+08:00">
                2019-04-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="20190429进度"><a href="#20190429进度" class="headerlink" title="20190429进度"></a>20190429进度</h1><h2 id="USB"><a href="#USB" class="headerlink" title="USB"></a>USB</h2><h3 id="先利用使用wireshark自带的tshark命令行工具，可以将-leftover-capture-data单独提取出来，具体如下：先在tshark文件夹下利用cmd命令行执行"><a href="#先利用使用wireshark自带的tshark命令行工具，可以将-leftover-capture-data单独提取出来，具体如下：先在tshark文件夹下利用cmd命令行执行" class="headerlink" title="先利用使用wireshark自带的tshark命令行工具，可以将 leftover capture data单独提取出来，具体如下：先在tshark文件夹下利用cmd命令行执行"></a>先利用使用wireshark自带的tshark命令行工具，可以将 leftover capture data单独提取出来，具体如下：先在tshark文件夹下利用cmd命令行执行</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark.exe -r usb1.pcap -T fields -e usb.capdata &gt; usbdata.txt</span><br></pre></td></tr></table></figure>
<h3 id="注意要以管理员身份运行cmd：在以下文件夹中右击以管理员打开cmd-exe"><a href="#注意要以管理员身份运行cmd：在以下文件夹中右击以管理员打开cmd-exe" class="headerlink" title="注意要以管理员身份运行cmd：在以下文件夹中右击以管理员打开cmd.exe"></a>注意要以管理员身份运行cmd：在以下文件夹中右击以管理员打开cmd.exe</h3><p><img src="https://i.imgur.com/74cIF8o.png" alt="Imgur"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\System32</span><br></pre></td></tr></table></figure></p>
<h3 id="可以得到usbdata-txt"><a href="#可以得到usbdata-txt" class="headerlink" title="可以得到usbdata.txt,"></a>可以得到usbdata.txt,</h3><p><img src="https://i.imgur.com/Jf0g8O3.png" alt="Imgur"></p>
<h3 id="可以看到每一个数据包的数据区有四个字节，故这是一个鼠标流量数据。第一个字节代表按键，当取0x00时，代表没有按键、为0x01时，代表按左键，为0x02时，代表当前按键为右键。第二个字节可以看成是一个signed-byte类型，其最高位为符号位，当这个值为正时，代表鼠标水平右移多少像素，为负时，代表水平左移多少像素。第三个字节与第二字节类似，代表垂直上下移动的偏移。"><a href="#可以看到每一个数据包的数据区有四个字节，故这是一个鼠标流量数据。第一个字节代表按键，当取0x00时，代表没有按键、为0x01时，代表按左键，为0x02时，代表当前按键为右键。第二个字节可以看成是一个signed-byte类型，其最高位为符号位，当这个值为正时，代表鼠标水平右移多少像素，为负时，代表水平左移多少像素。第三个字节与第二字节类似，代表垂直上下移动的偏移。" class="headerlink" title="可以看到每一个数据包的数据区有四个字节，故这是一个鼠标流量数据。第一个字节代表按键，当取0x00时，代表没有按键、为0x01时，代表按左键，为0x02时，代表当前按键为右键。第二个字节可以看成是一个signed byte类型，其最高位为符号位，当这个值为正时，代表鼠标水平右移多少像素，为负时，代表水平左移多少像素。第三个字节与第二字节类似，代表垂直上下移动的偏移。"></a>可以看到每一个数据包的数据区有四个字节，故这是一个鼠标流量数据。第一个字节代表按键，当取0x00时，代表没有按键、为0x01时，代表按左键，为0x02时，代表当前按键为右键。第二个字节可以看成是一个signed byte类型，其最高位为符号位，当这个值为正时，代表鼠标水平右移多少像素，为负时，代表水平左移多少像素。第三个字节与第二字节类似，代表垂直上下移动的偏移。</h3><h3 id="对网上的代码修改后可得："><a href="#对网上的代码修改后可得：" class="headerlink" title="对网上的代码修改后可得："></a>对网上的代码修改后可得：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">nums = []</span><br><span class="line">keys = open(&apos;usbdata.txt&apos;,&apos;r&apos;)</span><br><span class="line">posx = 0</span><br><span class="line">posy = 0</span><br><span class="line">for line in keys:</span><br><span class="line">    if len(line) != 10 : </span><br><span class="line">        continue</span><br><span class="line">    x = int(line[2:4],16)</span><br><span class="line">    y = int(line[4:6],16)</span><br><span class="line">    if x &gt; 127 :</span><br><span class="line">        x -= 256</span><br><span class="line">    if y &gt; 127 :</span><br><span class="line">        y -= 256</span><br><span class="line">    posx += x</span><br><span class="line">    posy += y</span><br><span class="line">    btn_flag = int(line[0:2],16)  # 1 for left , 2 for right , 0 for nothing</span><br><span class="line">    if btn_flag == 1 :</span><br><span class="line">        print posx , posy</span><br></pre></td></tr></table></figure>
<h3 id="运行后得到坐标点，"><a href="#运行后得到坐标点，" class="headerlink" title="运行后得到坐标点，"></a>运行后得到坐标点，</h3><p><img src="https://i.imgur.com/p1cFhTy.png" alt="Imgur"><br><img src="https://i.imgur.com/bk6Ql5Q.png" alt="Imgur"> </p>
<h3 id="再利用gnuplot绘图得到"><a href="#再利用gnuplot绘图得到" class="headerlink" title="再利用gnuplot绘图得到"></a>再利用gnuplot绘图得到</h3><p><img src="https://i.imgur.com/76UiSet.png" alt="Imgur"></p>
<h3 id="再利用手机操作进行镜像可以看到flag"><a href="#再利用手机操作进行镜像可以看到flag" class="headerlink" title="再利用手机操作进行镜像可以看到flag"></a>再利用手机操作进行镜像可以看到flag</h3><p><img src="https://i.imgur.com/CwVmGYd.jpg" alt="Imgur"></p>
<hr>
<h3 id="开始阅读白帽子讲web安全"><a href="#开始阅读白帽子讲web安全" class="headerlink" title="开始阅读白帽子讲web安全"></a>开始阅读白帽子讲web安全</h3>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/28/post20190428进度/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Conlonial">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Conlonial's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/28/post20190428进度/" itemprop="url">post20190428进度</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-28T19:27:02+08:00">
                2019-04-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="20190428进度"><a href="#20190428进度" class="headerlink" title="20190428进度"></a>20190428进度</h1><h3 id="练习了六个python编程题目，继续读python核心编程"><a href="#练习了六个python编程题目，继续读python核心编程" class="headerlink" title="练习了六个python编程题目，继续读python核心编程"></a>练习了六个python编程题目，继续读python核心编程</h3><h2 id="Pkcrake"><a href="#Pkcrake" class="headerlink" title="Pkcrake"></a>Pkcrake</h2><h3 id="利用advanced-zip-password-recovered-中plain-text模式，"><a href="#利用advanced-zip-password-recovered-中plain-text模式，" class="headerlink" title="利用advanced zip password recovered 中plain-text模式，"></a>利用advanced zip password recovered 中plain-text模式，</h3><p><img src="https://i.imgur.com/bjL5nCU.png" alt="Imgur"> </p>
<h3 id="在解出的Encrypted-zip文件中secrect-txt即得flag"><a href="#在解出的Encrypted-zip文件中secrect-txt即得flag" class="headerlink" title="在解出的Encrypted.zip文件中secrect.txt即得flag "></a>在解出的Encrypted.zip文件中secrect.txt即得flag <img src="https://i.imgur.com/JeCs9Aj.png" alt="Imgur"></h3><h2 id="Babybase"><a href="#Babybase" class="headerlink" title="Babybase"></a>Babybase</h2><h3 id="利用request和-base-对txt文件进行解码，因为不确定为base64或base32或16-，利用脚本："><a href="#利用request和-base-对txt文件进行解码，因为不确定为base64或base32或16-，利用脚本：" class="headerlink" title="利用request和 base 对txt文件进行解码，因为不确定为base64或base32或16 ，利用脚本："></a>利用request和 base 对txt文件进行解码，因为不确定为base64或base32或16 ，利用脚本：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">def download(url):</span><br><span class="line">    return requests.get(url).text</span><br><span class="line"></span><br><span class="line">steps = []</span><br><span class="line">url = &quot;https://oj.blue-whale.me/files/static/uploads/bbb45d3f0b5da971903660c57ac8780f/base.txt&quot;</span><br><span class="line"></span><br><span class="line">print &quot;[+] Downloading encrypted file...&quot;</span><br><span class="line">p = download(url)</span><br><span class="line">n = &quot;&quot;</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    # Base16</span><br><span class="line">    try:</span><br><span class="line">        print &quot;[?] using base16 deocde&quot;</span><br><span class="line">        n = base64.b16decode(p)</span><br><span class="line">        print &quot;[+] %s&quot; % (n)</span><br><span class="line">        steps.append(16)</span><br><span class="line">        p = n</span><br><span class="line">        continue</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">    # Base32</span><br><span class="line">    try:</span><br><span class="line">        print &quot;[?] using base32 deocde&quot;</span><br><span class="line">        n = base64.b32decode(p)</span><br><span class="line">        print &quot;[+] %s&quot; % (n)</span><br><span class="line">        steps.append(32)</span><br><span class="line">        p = n</span><br><span class="line">        continue</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">    # Base64</span><br><span class="line">    try:</span><br><span class="line">        print &quot;[?] using base64 deocde&quot;</span><br><span class="line">        n = base64.b64decode(p)</span><br><span class="line">        print &quot;[+] %s&quot; % (n)</span><br><span class="line">        steps.append(64)</span><br><span class="line">        p = n</span><br><span class="line">        continue</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">    break</span><br><span class="line"></span><br><span class="line">print &quot;[+] flag found : %s&quot; % (n)</span><br><span class="line">print &quot;[+] steps : %s&quot; % (steps)</span><br></pre></td></tr></table></figure>
<h3 id="解得flag"><a href="#解得flag" class="headerlink" title="解得flag "></a>解得flag <img src="https://i.imgur.com/vpk9bzK.png" alt="Imgur"></h3>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/25/20190425进度/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Conlonial">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Conlonial's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/25/20190425进度/" itemprop="url">20190425进度</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-25T20:18:30+08:00">
                2019-04-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="20190425进度"><a href="#20190425进度" class="headerlink" title="20190425进度"></a>20190425进度</h1><h2 id="Forensics1"><a href="#Forensics1" class="headerlink" title="Forensics1"></a>Forensics1</h2><h3 id="用wireshake-打开文件，分析http部分"><a href="#用wireshake-打开文件，分析http部分" class="headerlink" title="用wireshake 打开文件，分析http部分:"></a>用wireshake 打开文件，分析http部分:</h3><p><img src="https://i.imgur.com/jlZdhen.png" alt="Imgur"></p>
<h3 id="可以看到传送的内容是一张png图片"><a href="#可以看到传送的内容是一张png图片" class="headerlink" title="可以看到传送的内容是一张png图片:"></a>可以看到传送的内容是一张png图片:</h3><p><img src="https://i.imgur.com/fHTaMPk.png" alt="Imgur"></p>
<h3 id="png图片文件头标志是8950-4e47-0d0a-1a0a，故对原始数据内以8950-4e47-0d0a-1a0a开头的部分进行截取即为图片部分："><a href="#png图片文件头标志是8950-4e47-0d0a-1a0a，故对原始数据内以8950-4e47-0d0a-1a0a开头的部分进行截取即为图片部分：" class="headerlink" title="png图片文件头标志是8950 4e47 0d0a 1a0a，故对原始数据内以8950 4e47 0d0a 1a0a开头的部分进行截取即为图片部分："></a>png图片文件头标志是8950 4e47 0d0a 1a0a，故对原始数据内以8950 4e47 0d0a 1a0a开头的部分进行截取即为图片部分：</h3><p><img src="https://i.imgur.com/JfaeROK.png" alt="Imgur"></p>
<h3 id="将图片部分以原始数据截取下来后进行处理，先将数据以png格式保存"><a href="#将图片部分以原始数据截取下来后进行处理，先将数据以png格式保存" class="headerlink" title="将图片部分以原始数据截取下来后进行处理，先将数据以png格式保存"></a>将图片部分以原始数据截取下来后进行处理，先将数据以png格式保存</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">f = open(&apos;pc.png&apos;,&apos;wb&apos;)#文件以二进制写模式打开</span><br><span class="line">s =&apos;89504e470d0a1a0a0000000d49484452000000c8000000c80802000000223a39c9000005104944415478daedd9516ed34800c7e140d5f78a7b0097e08d23a00a55ea05ca41ca059050857a04de7a89967b54483c2228b33bda617662bb21c9bf80f47d0fabc64decf1f8e771b63cbabbbb5bc1be3d121609c222425844088b086111212c22844584b088101611c222425844088b086111212c228445c4cfb0be7dfb767878587ffefaf5ebc1c1c1e3c78febcbefdfbf6f7d80ba93dbdbdba3a3a385b77dfaf4e9f9f3e7db1d6897717efefcf9e3c78faf5ebdda7d2aff46272727171717f75e9d2dfc0cebf2f2f2d9b3674f9f3eed7f5d6bdb3aac92cbcdcdcd26976d97b07619e75c58933bdc71367eafb9c19719383b3b7bfffefd7e0ff733ac12efdbb76f8772779ccac9581f72d6ee25acd5bf4bfede4fea9fb0ea7ad8367df8f0a14df4fa68da7367d53d7a4a40c7c7c76d7b7d92aea6c2aa2bd3f0b6f5675919d29b376fca3bafafafebfbcbaf6a0457575775b4ede393e3ec0fb4306b759fe5873afebacf61425ebf7e5d6ee8c98d0b439abc7eed74da244f8eb3df58dfd9df00fd73e0de8f2f9c513cac762d7f69c56aa7d7afa54349e5e5cb972ffb7dce9dc370a03298172f5e94cf3e79f2a44ccde9e9e9bb77efbe7cf9525ed62f04e5e8e7e7e76d76868ff7976179a92fbf6dfb2ca32d5beaa7365cb1fa8f0f439a0bab4e4e9d87c971d67dd6a3f493bc1ed6dc694e4ef2f28ab57c4b3c4458fde2d46ea6f5b0fa19ef7738f76d713dac3298f243dd737959c36af338bc7f78d9dfb2abb51b74086b7225d83cacb9214d5ebfe1b793e3ec6fcee5b0e64e7372929787573e52febbc76f5abf1656df507f19dab36cb88493fb5cfd57677fe6fb0d6bf3ef76bf37acc9716e1ed6f2690e93fc47af58fd6a5f465357acb2b1bc9c3cbd85331ffe87f157c3ea1f5baba91ba03d4d96cd853537ddc3c6fee3c39026afdf30a4c971b649ae27353c16868dcba7b9c919ad1ef83b56ff67adaa1ebb2d4ee5ebc2fa8ab5faff77ff21ac619f758793079a0babcc637d4f5b1ae7c6d93f26da379b750b61b53df4cbf0b0b15eda61487326afdfe438db77edb2deb4e1b58dfdccaf7f7c729217ce68950e6b6bc39ddadf16fbfd73c31ff8c7ccf49036ff43e02efe82b086c579bff322acd02964ff40bab561ed1d9ee27bfc47835dae62ffcc6aee7d786d31a4fd1e281dd643fc930eec91b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222425844088b086111212c22844584b088101611c222e20759b4e8cb3d42ad580000000049454e44ae426082&apos;</span><br><span class="line">f = write(s.decode(&apos;hex&apos;))</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<h3 id="图片内即为flag"><a href="#图片内即为flag" class="headerlink" title="图片内即为flag"></a>图片内即为flag</h3><p><img src="https://i.imgur.com/Ru1gpDc.png" alt="Imgur"></p>
<hr>
<h2 id="Invisible-flag"><a href="#Invisible-flag" class="headerlink" title="Invisible flag"></a>Invisible flag</h2><h3 id="打开图片后发现长度不够，内容显示不全，通过010editor分析，可知图片的16进制编码格式"><a href="#打开图片后发现长度不够，内容显示不全，通过010editor分析，可知图片的16进制编码格式" class="headerlink" title="打开图片后发现长度不够，内容显示不全，通过010editor分析，可知图片的16进制编码格式:"></a>打开图片后发现长度不够，内容显示不全，通过010editor分析，可知图片的16进制编码格式:</h3><p><img src="https://i.imgur.com/Vjz6U1W.png" alt="Imgur"></p>
<h3 id="除了png文件头标志外接下来的地方就是IHDR数据块："><a href="#除了png文件头标志外接下来的地方就是IHDR数据块：" class="headerlink" title="除了png文件头标志外接下来的地方就是IHDR数据块："></a>除了png文件头标志外接下来的地方就是IHDR数据块：</h3><h3 id="0000-000d为IHDR头块长"><a href="#0000-000d为IHDR头块长" class="headerlink" title="0000 000d为IHDR头块长"></a>0000 000d为IHDR头块长</h3><h3 id="4948-4452IHDR标识"><a href="#4948-4452IHDR标识" class="headerlink" title="4948 4452IHDR标识"></a>4948 4452IHDR标识</h3><h3 id="0000-0234图像的宽"><a href="#0000-0234图像的宽" class="headerlink" title="0000 0234图像的宽"></a>0000 0234图像的宽</h3><h3 id="0000-0190图像的高"><a href="#0000-0190图像的高" class="headerlink" title="0000 0190图像的高"></a>0000 0190图像的高</h3><h3 id="图片是一个564-400的图片，试着用tweakpng将图片高修改到564时即得flag"><a href="#图片是一个564-400的图片，试着用tweakpng将图片高修改到564时即得flag" class="headerlink" title="图片是一个564*400的图片，试着用tweakpng将图片高修改到564时即得flag"></a>图片是一个564*400的图片，试着用tweakpng将图片高修改到564时即得flag</h3><p><img src="https://i.imgur.com/EUUhMPr.png" alt="Imgur"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/24/20190424进度/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Conlonial">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Conlonial's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/24/20190424进度/" itemprop="url">20190424进度</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-24T22:57:30+08:00">
                2019-04-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="20190424进度"><a href="#20190424进度" class="headerlink" title="20190424进度"></a>20190424进度</h1><h2 id="Calculator"><a href="#Calculator" class="headerlink" title="Calculator"></a>Calculator</h2><h3 id="学习request库的用法后，思路是写脚本把算式部分截取后计算，加上cookies再发送上服务器。再返回的即为flag"><a href="#学习request库的用法后，思路是写脚本把算式部分截取后计算，加上cookies再发送上服务器。再返回的即为flag" class="headerlink" title="学习request库的用法后，思路是写脚本把算式部分截取后计算，加上cookies再发送上服务器。再返回的即为flag"></a>学习request库的用法后，思路是写脚本把算式部分截取后计算，加上cookies再发送上服务器。再返回的即为flag</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">r = requests.get(&apos;http://web1.blue-whale.me:23331/calculator/&apos;) </span><br><span class="line">print eval (r.text[515:-133])</span><br><span class="line">p = eval (r.text[515:-133])</span><br><span class="line">r = requests.get (&apos;http://web1.blue-whale.me:23331/calculator/?answer=&apos;+str(p), cookies=r.cookies)</span><br><span class="line">print r.text</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/R8YnU3R.png" alt="Imgur"></p>
<hr>
<h1 id="reverse-sign-in"><a href="#reverse-sign-in" class="headerlink" title="reverse sign in"></a>reverse sign in</h1><h3 id="通过分析main函数，看到如下的逻辑关系："><a href="#通过分析main函数，看到如下的逻辑关系：" class="headerlink" title="通过分析main函数，看到如下的逻辑关系："></a>通过分析main函数，看到如下的逻辑关系：</h3><p><img src="https://i.imgur.com/1x4YTlc.png" alt="Imgur"></p>
<h3 id="i与所给内存异或后为i的值即为所求。代码如下："><a href="#i与所给内存异或后为i的值即为所求。代码如下：" class="headerlink" title="i与所给内存异或后为i的值即为所求。代码如下："></a>i与所给内存异或后为i的值即为所求。代码如下：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">d =[0x66,0x6d,0x63,0x64,0x7f,0x3c,0x36,0x72,0x57,0x42,0x64,0x3b,0x7b,0x52,0x7c,0x3c,0x66,0x54,0x60,0x60,0x27,0x4a,0x49,0x7f,0x71,0x58,0x52,0x72,0x7d,0x75,0x2a,0x62,0x00]</span><br><span class="line">table = []</span><br><span class="line">for i in range(0,32):</span><br><span class="line">    table.append(i^d[i])</span><br><span class="line">print table</span><br></pre></td></tr></table></figure>
<h3 id="把得到的列表转化为字符串形式，再把每个数字转化为ascii码即为flag"><a href="#把得到的列表转化为字符串形式，再把每个数字转化为ascii码即为flag" class="headerlink" title="把得到的列表转化为字符串形式，再把每个数字转化为ascii码即为flag"></a>把得到的列表转化为字符串形式，再把每个数字转化为ascii码即为flag</h3>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/22/20190422做题总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Conlonial">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Conlonial's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/22/20190422做题总结/" itemprop="url">20190422做题总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-22T15:51:34+08:00">
                2019-04-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="20190422做题总结"><a href="#20190422做题总结" class="headerlink" title="20190422做题总结"></a>20190422做题总结</h1><h2 id="1-RSA2"><a href="#1-RSA2" class="headerlink" title="1. RSA2"></a>1. RSA2</h2><h3 id="首先对pubkey-pem进行信息提取"><a href="#首先对pubkey-pem进行信息提取" class="headerlink" title="首先对pubkey.pem进行信息提取"></a>首先对pubkey.pem进行信息提取</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl rsa -pubin -text -modulus -in pubkey.pem</span><br></pre></td></tr></table></figure>
<h3 id="得到n和e"><a href="#得到n和e" class="headerlink" title="得到n和e"></a>得到n和e<img src="https://i.imgur.com/eFJzzl3.png" alt="Imgur"></h3><h3 id="对n在http-factordb-com-进行在线分解，得p，q-Imgur-https-i-imgur-com-nog6NnU-png"><a href="#对n在http-factordb-com-进行在线分解，得p，q-Imgur-https-i-imgur-com-nog6NnU-png" class="headerlink" title="对n在http://factordb.com/进行在线分解，得p，q![Imgur](https://i.imgur.com/nog6NnU.png)"></a>对n在<a href="http://factordb.com/进行在线分解，得p，q![Imgur](https://i.imgur.com/nog6NnU.png)" target="_blank" rel="noopener">http://factordb.com/进行在线分解，得p，q![Imgur](https://i.imgur.com/nog6NnU.png)</a></h3><h3 id="此时已知p，q，e即可得到d为"><a href="#此时已知p，q，e即可得到d为" class="headerlink" title="此时已知p，q，e即可得到d为"></a>此时已知p，q，e即可得到d为</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"># coding = utf-8</span><br><span class="line">def computeD(fn, e):</span><br><span class="line">    (x, y, r) = extendedGCD(fn, e)</span><br><span class="line">    #y maybe &lt; 0, so convert it</span><br><span class="line">    if y &lt; 0:</span><br><span class="line">        return fn + y</span><br><span class="line">    return y</span><br><span class="line"> </span><br><span class="line">def extendedGCD(a, b):</span><br><span class="line">    #a*xi + b*yi = ri</span><br><span class="line">    if b == 0:</span><br><span class="line">        return (1, 0, a)</span><br><span class="line">    #a*x1 + b*y1 = a</span><br><span class="line">    x1 = 1</span><br><span class="line">    y1 = 0</span><br><span class="line">    #a*x2 + b*y2 = b</span><br><span class="line">    x2 = 0</span><br><span class="line">    y2 = 1</span><br><span class="line">    while b != 0:</span><br><span class="line">        q = a / b</span><br><span class="line">        #ri = r(i-2) % r(i-1)</span><br><span class="line">        r = a % b</span><br><span class="line">        a = b</span><br><span class="line">        b = r</span><br><span class="line">        #xi = x(i-2) - q*x(i-1)</span><br><span class="line">        x = x1 - q*x2</span><br><span class="line">        x1 = x2</span><br><span class="line">        x2 = x</span><br><span class="line">        #yi = y(i-2) - q*y(i-1)</span><br><span class="line">        y = y1 - q*y2</span><br><span class="line">        y1 = y2</span><br><span class="line">        y2 = y</span><br><span class="line">    return(x1, y1, a)</span><br><span class="line"> </span><br><span class="line">p = 275127860351348928173285174381581152299</span><br><span class="line">q = 319576316814478949870590164193048041239</span><br><span class="line">e = 65537</span><br><span class="line"> </span><br><span class="line">n = p * q</span><br><span class="line">fn = (p - 1) * (q - 1)</span><br><span class="line"> </span><br><span class="line">d = computeD(fn, e)</span><br><span class="line">print d</span><br></pre></td></tr></table></figure>
<h3 id="运行结果如下"><a href="#运行结果如下" class="headerlink" title="运行结果如下"></a>运行结果如下</h3><p><img src="https://i.imgur.com/kkQ8trw.png" alt="Imgur"></p>
<h3 id="此时d已知，即可对flag-encrypt这一密文先进行读取："><a href="#此时d已知，即可对flag-encrypt这一密文先进行读取：" class="headerlink" title="此时d已知，即可对flag.encrypt这一密文先进行读取："></a>此时d已知，即可对flag.encrypt这一密文先进行读取：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;f = open(&apos;flag.encrypt&apos;)</span><br><span class="line">&gt;&gt;p = f.read()</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/qFGmU3B.png" alt="Imgur"></p>
<h3 id="即可看到密文内容，接着对密文内容进行16进制编码："><a href="#即可看到密文内容，接着对密文内容进行16进制编码：" class="headerlink" title="即可看到密文内容，接着对密文内容进行16进制编码："></a>即可看到密文内容，接着对密文内容进行16进制编码：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;p.encode(&apos;hex&apos;)</span><br></pre></td></tr></table></figure>
<h3 id="就得到它16进制的形式：8fbb3b0f58b88b53e79d85c1ed68c355ac57c75884bd1e8e21c7ae9c6c82ddbb"><a href="#就得到它16进制的形式：8fbb3b0f58b88b53e79d85c1ed68c355ac57c75884bd1e8e21c7ae9c6c82ddbb" class="headerlink" title="就得到它16进制的形式：8fbb3b0f58b88b53e79d85c1ed68c355ac57c75884bd1e8e21c7ae9c6c82ddbb"></a>就得到它16进制的形式：8fbb3b0f58b88b53e79d85c1ed68c355ac57c75884bd1e8e21c7ae9c6c82ddbb</h3><h3 id="在转换为字符串，即为c："><a href="#在转换为字符串，即为c：" class="headerlink" title="在转换为字符串，即为c："></a>在转换为字符串，即为c：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;c=0x8fbb3b0f58b88b53e79d85c1ed68c355ac57c75884bd1e8e21c7ae9c6c82ddbb</span><br><span class="line">&gt;&gt;print c</span><br></pre></td></tr></table></figure>
<h3 id="现在利用公式pow（c，d，n）就可以得到明文十进制形式"><a href="#现在利用公式pow（c，d，n）就可以得到明文十进制形式" class="headerlink" title="现在利用公式pow（c，d，n）就可以得到明文十进制形式"></a>现在利用公式pow（c，d，n）就可以得到明文十进制形式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;d = 10866948760844599168252082612378495977388271279679231539839049698621994994673</span><br><span class="line"></span><br><span class="line">&gt;&gt;n = 87924348264132406875276140514499937145050893665602592992418171647042491658461</span><br><span class="line"></span><br><span class="line">&gt;&gt;pow(c.d.n)</span><br></pre></td></tr></table></figure>
<h3 id="十进制形式无法进行编码，故要转换为16进制-利用hex："><a href="#十进制形式无法进行编码，故要转换为16进制-利用hex：" class="headerlink" title="十进制形式无法进行编码，故要转换为16进制,利用hex："></a>十进制形式无法进行编码，故要转换为16进制,利用hex：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;pp = 10786438895796771334553405582542071004794259807619608563847580041597</span><br><span class="line">&gt;&gt;hex(pp)</span><br></pre></td></tr></table></figure>
<h3 id="最后解密可得flag："><a href="#最后解密可得flag：" class="headerlink" title="最后解密可得flag："></a>最后解密可得flag：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;s=&apos;666c61677b5930755f6d34795f754e6433727374616e645f5253417d&apos;</span><br><span class="line">&gt;&gt;s.decode(&apos;hex&apos;)</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/zQaStkg.png" alt="Imgur"></p>
<hr>
<h2 id="Wiener-Tricky"><a href="#Wiener-Tricky" class="headerlink" title="Wiener Tricky"></a>Wiener Tricky</h2><h3 id="首先同上对rsa-pub-pem进行信息提取，再对n进行分解，发现n太大无法分解。根据题目，可知要采取维纳攻击，在网上查找到相关的代码，https-github-com-pablocelayes-rsa-wiener-attack-后下载所有代码于桌面，运行程序可得解密密钥d"><a href="#首先同上对rsa-pub-pem进行信息提取，再对n进行分解，发现n太大无法分解。根据题目，可知要采取维纳攻击，在网上查找到相关的代码，https-github-com-pablocelayes-rsa-wiener-attack-后下载所有代码于桌面，运行程序可得解密密钥d" class="headerlink" title="首先同上对rsa_pub.pem进行信息提取，再对n进行分解，发现n太大无法分解。根据题目，可知要采取维纳攻击，在网上查找到相关的代码，https://github.com/pablocelayes/rsa-wiener-attack 后下载所有代码于桌面，运行程序可得解密密钥d:"></a>首先同上对rsa_pub.pem进行信息提取，再对n进行分解，发现n太大无法分解。根据题目，可知要采取维纳攻击，在网上查找到相关的代码，<a href="https://github.com/pablocelayes/rsa-wiener-attack" target="_blank" rel="noopener">https://github.com/pablocelayes/rsa-wiener-attack</a> 后下载所有代码于桌面，运行程序可得解密密钥d:</h3><p> <img src="https://i.imgur.com/S2BNdxu.png" alt="Imgur"></p>
<h3 id="接下来步骤同上题，提取flag-enc文件内容"><a href="#接下来步骤同上题，提取flag-enc文件内容" class="headerlink" title="接下来步骤同上题，提取flag.enc文件内容"></a>接下来步骤同上题，提取flag.enc文件内容</h3><p> <img src="https://i.imgur.com/AXjuGyr.png" alt="Imgur"></p>
<h3 id="进行16进制编码，再转为10进制c"><a href="#进行16进制编码，再转为10进制c" class="headerlink" title="进行16进制编码，再转为10进制c:"></a>进行16进制编码，再转为10进制c:</h3><p> <img src="https://i.imgur.com/WyyviDM.png" alt="Imgur"></p>
<h3 id="现已知c，d，n，即可求明文pp："><a href="#现已知c，d，n，即可求明文pp：" class="headerlink" title="现已知c，d，n，即可求明文pp："></a>现已知c，d，n，即可求明文pp：</h3><p> <img src="https://i.imgur.com/LmmMFEo.png" alt="Imgur"></p>
<h3 id="将明文变为16进制后在解密即得flag"><a href="#将明文变为16进制后在解密即得flag" class="headerlink" title="将明文变为16进制后在解密即得flag"></a>将明文变为16进制后在解密即得flag</h3><p> <img src="https://i.imgur.com/sxMp9Us.png" alt="Imgur"><br> <img src="https://i.imgur.com/ljNw0Ta.png" alt="Imgur"></p>
<blockquote>
<h3 id="但这时发现报错TypeError-Odd-length-string"><a href="#但这时发现报错TypeError-Odd-length-string" class="headerlink" title="但这时发现报错TypeError: Odd-length string"></a>但这时发现报错TypeError: Odd-length string</h3></blockquote>
<h3 id="经过搜索得知错误原因为字符串长度为奇数-一位16进制数转换为4位二进制数-所以奇数个16进制数无法刚好转换为整数个字节。而高位的0经常被省略，所以在高位补零后得到flag："><a href="#经过搜索得知错误原因为字符串长度为奇数-一位16进制数转换为4位二进制数-所以奇数个16进制数无法刚好转换为整数个字节。而高位的0经常被省略，所以在高位补零后得到flag：" class="headerlink" title="经过搜索得知错误原因为字符串长度为奇数, 一位16进制数转换为4位二进制数, 所以奇数个16进制数无法刚好转换为整数个字节。而高位的0经常被省略，所以在高位补零后得到flag："></a>经过搜索得知错误原因为字符串长度为奇数, 一位16进制数转换为4位二进制数, 所以奇数个16进制数无法刚好转换为整数个字节。而高位的0经常被省略，所以在高位补零后得到flag：</h3><p><img src="https://i.imgur.com/nAltjDV.png" alt="Imgur"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/19/post/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Conlonial">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Conlonial's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/19/post/" itemprop="url">post</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-19T22:38:34+08:00">
                2019-04-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="python学习到基本数据类型，编写了例程"><a href="#python学习到基本数据类型，编写了例程" class="headerlink" title="python学习到基本数据类型，编写了例程"></a>python学习到基本数据类型，编写了例程</h1><h1 id="准备看书第三章的内容"><a href="#准备看书第三章的内容" class="headerlink" title="准备看书第三章的内容"></a>准备看书第三章的内容</h1>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/17/20190417学习进度/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Conlonial">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Conlonial's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/17/20190417学习进度/" itemprop="url">20190417学习进度</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-17T18:03:52+08:00">
                2019-04-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="第二章读完，主要了解了程序执行的步骤，从头文件被预编译到高级语言编译、高级语言转为机器语言的过程。"><a href="#第二章读完，主要了解了程序执行的步骤，从头文件被预编译到高级语言编译、高级语言转为机器语言的过程。" class="headerlink" title="第二章读完，主要了解了程序执行的步骤，从头文件被预编译到高级语言编译、高级语言转为机器语言的过程。"></a>第二章读完，主要了解了程序执行的步骤，从头文件被预编译到高级语言编译、高级语言转为机器语言的过程。</h1><h1 id="python学习到数据类型，简单随例程进行了编写"><a href="#python学习到数据类型，简单随例程进行了编写" class="headerlink" title="python学习到数据类型，简单随例程进行了编写"></a>python学习到数据类型，简单随例程进行了编写</h1>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Conlonial</p>
              <p class="site-description motion-element" itemprop="description">recorder</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">17</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Conlonial</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
